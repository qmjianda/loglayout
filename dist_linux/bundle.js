import Xt from"react";import{createRoot as Zt}from"react-dom/client";import{useState as A,useMemo as Ve,useEffect as je,useCallback as Me,useRef as Mt}from"react";import{jsx as oe,jsxs as ot}from"react/jsx-runtime";var rt=({activeView:n,onSetActiveView:b})=>ot("div",{className:"w-12 bg-[#333333] flex flex-col items-center py-2 shrink-0",children:[[{id:"explorer",icon:oe("path",{d:"M5 4h14v16H5V4zm2 2v12h10V6H7z"}),label:"\u8D44\u6E90\u7BA1\u7406\u5668"},{id:"search",icon:oe("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}),label:"\u641C\u7D22"},{id:"layers",icon:oe("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5-10-5-10 5zM2 12l10 5 10-5-10-5-10 5z"}),label:"\u56FE\u5C42"},{id:"presets",icon:oe("path",{d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}),label:"\u9884\u8BBE"},{id:"help",icon:oe("path",{d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),label:"\u5E2E\u52A9\u4E0E API"}].map(o=>ot("button",{onClick:()=>b(o.id),className:`w-12 h-12 flex items-center justify-center relative group transition-colors ${n===o.id?"text-white":"text-gray-500 hover:text-gray-300"}`,children:[n===o.id&&oe("div",{className:"absolute left-0 w-0.5 h-full bg-white"}),oe("svg",{className:"w-6 h-6",fill:o.id==="layers"?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"1.5",children:o.icon}),oe("span",{className:"absolute left-14 bg-[#252526] text-white text-[10px] px-2 py-1 rounded hidden group-hover:block whitespace-nowrap z-50 shadow-lg",children:o.label})]},o.id)),oe("div",{className:"mt-auto",children:oe("button",{className:"w-12 h-12 flex items-center justify-center text-gray-500 hover:text-gray-300",children:oe("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:oe("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})})})})]});import{useRef as Ht,useState as st,useEffect as nt}from"react";import{jsx as le,jsxs as zt}from"react/jsx-runtime";var at=({lines:n,searchQuery:b,searchConfig:p,scrollToIndex:o,highlightedIndex:g,onLineClick:f})=>{let v=Ht(null),[l,w]=st(0),[L,x]=st(0),m=20,P=25;nt(()=>{let N=()=>{v.current&&x(v.current.clientHeight)};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]),nt(()=>{if(o!=null&&v.current){let N=o<1&&n.length>1e3?Math.floor(o*n.length):o,I=Math.max(0,N*m-L/3);v.current.scrollTo({top:I,behavior:"auto"})}},[o,n.length,L]);let h=Math.max(0,Math.floor(l/m)-P),k=Math.min(n.length,Math.floor((l+L)/m)+P),S=n.slice(h,k),M=N=>{let I=N.displayContent||N.content;if(!N.highlights||N.highlights.length===0)return le("span",{children:I});let C=[...N.highlights].sort((O,$)=>O.start-$.start||$.end-O.end),G=[],re=0;for(let O=0;O<C.length;O++){let $=C[O];if($.start>=I.length)break;if($.start<re)continue;$.start>re&&G.push(le("span",{children:I.substring(re,$.start)},`t-${O}`));let xe=($.opacity||100)/100,ce=Math.min($.end,I.length);G.push(le("span",{style:{backgroundColor:$.color.startsWith("#")?`${$.color}${Math.floor(xe*255).toString(16).padStart(2,"0")}`:$.color,color:"#fff",padding:"0 1px",borderRadius:"1px"},children:I.substring($.start,ce)},`h-${O}`)),re=ce}return re<I.length&&G.push(le("span",{children:I.substring(re)},"end")),G};return le("div",{ref:v,onScroll:N=>w(N.currentTarget.scrollTop),className:"flex-1 overflow-auto bg-[#1e1e1e] font-mono text-[12px] relative custom-scrollbar",children:le("div",{style:{height:`${n.length*m}px`,width:"100%"},children:le("div",{className:"absolute top-0 left-0 w-full",style:{transform:`translateY(${h*m}px)`},children:S.map((N,I)=>{let C=h+I,G=g===C;return zt("div",{onClick:()=>f?.(C),className:`flex hover:bg-[#2a2d2e] px-4 h-[20px] items-center whitespace-pre border-l-2 transition-colors cursor-default
                  ${N.isMarked?"border-yellow-500":"border-transparent"}
                  ${G?"bg-[#3b82f6]/20":""}`,style:G?{backgroundColor:"rgba(59, 130, 246, 0.2)"}:void 0,children:[le("div",{className:`w-14 text-right pr-4 shrink-0 select-none text-[10px] ${G?"text-blue-400 font-bold":"text-gray-600"}`,children:N.index+1}),le("div",{className:"flex-1 overflow-hidden truncate text-[#d4d4d4]",children:M(N)})]},`${N.index}`)})})})})};import $t,{useState as me}from"react";import{jsx as ye,jsxs as it}from"react/jsx-runtime";var lt=({value:n,onChange:b,config:p,onConfigChange:o,placeholder:g="\u641C\u7D22...",onMouseEnter:f,onMouseLeave:v})=>it("div",{className:"relative flex items-center w-full group",onMouseEnter:f,onMouseLeave:v,children:[ye("input",{type:"text",className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 pr-20 text-[11px] rounded text-gray-200 w-full focus:outline-none focus:border-blue-500 select-text",value:n,onChange:l=>b(l.target.value),placeholder:g,onMouseDown:l=>l.stopPropagation()}),it("div",{className:"absolute right-1 flex items-center space-x-0.5 pointer-events-auto",children:[ye("button",{onClick:l=>{l.stopPropagation(),o({...p,caseSensitive:!p.caseSensitive})},className:`w-5 h-5 flex items-center justify-center rounded text-[10px] transition-colors ${p.caseSensitive?"bg-blue-600 text-white":"text-gray-500 hover:bg-[#444]"}`,title:"\u533A\u5206\u5927\u5C0F\u5199 (Alt+C)",children:"Aa"}),ye("button",{onClick:l=>{l.stopPropagation(),o({...p,wholeWord:!p.wholeWord})},className:`w-5 h-5 flex items-center justify-center rounded text-[10px] transition-colors ${p.wholeWord?"bg-blue-600 text-white":"text-gray-500 hover:bg-[#444]"}`,title:"\u5168\u5B57\u5339\u914D (Alt+W)",children:ye("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:ye("path",{strokeWidth:"2.5",d:"M3 12h18M3 6h18M3 18h18"})})}),ye("button",{onClick:l=>{l.stopPropagation(),o({...p,regex:!p.regex})},className:`w-5 h-5 flex items-center justify-center rounded text-[10px] transition-colors ${p.regex?"bg-blue-600 text-white":"text-gray-400"}`,title:"\u4F7F\u7528\u6B63\u5219\u8868\u8FBE\u5F0F (Alt+R)",children:".*"})]})]});import{jsx as i,jsxs as W}from"react/jsx-runtime";var dt=({layers:n,stats:b,rawCounts:p={},selectedId:o,onSelect:g,onRemove:f,onToggle:v,onUpdate:l,onDrop:w,onJumpToLine:L})=>{let[x,m]=me(null),[P,h]=me(null),[k,S]=me(null),[M,N]=me(null),[I,C]=me(!1),[G,re]=me(null),[O,$]=me({x:0,y:0}),xe=(e,F)=>{let T=e.target;if(T.tagName==="INPUT"||T.tagName==="TEXTAREA"||M===F||I){e.preventDefault();return}h(F),e.dataTransfer.setData("layerId",F),e.dataTransfer.effectAllowed="move",e.currentTarget.classList.add("dragging")},ce=e=>{e.currentTarget.classList.remove("dragging"),m(null),S(null),h(null)},Pe=(e,F,T)=>{if(e.preventDefault(),P===F)return;let H=e.currentTarget.getBoundingClientRect(),Q=e.clientY-H.top;m(F),T==="FOLDER"&&Q>H.height*.25&&Q<H.height*.75?S("inside"):Q<H.height/2?S("before"):S("after")},Ce=(e,F)=>{e.preventDefault();let T=e.dataTransfer.getData("layerId");T&&T!==F&&k&&w(T,F,k),m(null),S(null),h(null)},Te=e=>{switch(e.type){case"FILTER":return i("svg",{className:"w-3.5 h-3.5 text-blue-400",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:i("path",{d:"M3 4h18l-7 9v6l-4 2V13L3 4z"})});case"HIGHLIGHT":return i("svg",{className:"w-3.5 h-3.5 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:i("path",{d:"M12 21a9 9 0 110-18 9 9 0 010 18z"})});case"RANGE":return i("svg",{className:"w-3.5 h-3.5 text-teal-400",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:i("path",{d:"M7 8l-4 4 4 4M17 8l4 4-4 4M13 4l-2 16"})});case"TIME_RANGE":return i("svg",{className:"w-3.5 h-3.5 text-purple-400",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:i("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})});case"TRANSFORM":return i("svg",{className:"w-3.5 h-3.5 text-orange-400",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:i("path",{d:"M4 4h16v16H4V4zm4 4h8v8H8V8z"})});case"FOLDER":return i("svg",{className:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})});case"LEVEL":return i("svg",{className:"w-3.5 h-3.5 text-red-400",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:i("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});default:return i("svg",{className:"w-3.5 h-3.5 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:i("path",{d:"M4 6h16M4 12h16M4 18h16"})})}},Ee=e=>{$({x:e.clientX+15,y:e.clientY+10})},Ae=(e,F=0)=>{let T=o===e.id,H=x===e.id,Q=P===e.id,U=e.type==="FOLDER",he=M===e.id,_=e.groupId?n.find(r=>r.id===e.groupId):null,be=!e.enabled||_&&!_.enabled,q=e.config.color||(e.type==="RANGE"?"#2dd4bf":e.type==="TIME_RANGE"?"#a855f7":e.type==="TRANSFORM"?"#fb923c":e.type==="LEVEL"?"#f87171":"#3b82f6"),Re=b[e.id]?.count||0;return W("div",{draggable:!he&&!I,onDragStart:r=>xe(r,e.id),onDragEnd:ce,onDragOver:r=>Pe(r,e.id,e.type),onDragLeave:r=>{r.currentTarget.contains(r.relatedTarget)||(m(null),S(null))},onDrop:r=>Ce(r,e.id),onMouseEnter:()=>!U&&re(e.id),onMouseLeave:()=>re(null),onMouseMove:Ee,onMouseDown:r=>{let te=r.target;te.tagName!=="INPUT"&&te.tagName!=="BUTTON"&&!te.closest("button")&&g(e.id)},onDoubleClick:()=>N(e.id),className:`flex flex-col border-b border-[#111] relative group transition-all overflow-hidden
          ${T?"bg-[#37373d]":"bg-[#252526] hover:bg-[#2d2d30]"}
          ${H&&k==="inside"?"bg-blue-500/10":""}
          ${be?"opacity-40":""}`,children:[H&&k==="before"&&i("div",{className:"absolute top-0 left-0 right-0 h-[2px] bg-blue-500 z-50 pointer-events-none"}),H&&k==="after"&&i("div",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-blue-500 z-50 pointer-events-none"}),W("div",{className:"flex items-center py-1 min-h-[32px] overflow-hidden",style:{paddingLeft:`${F*10+2}px`},children:[i("div",{className:`w-6 h-6 flex items-center justify-center shrink-0 cursor-pointer hover:bg-white/5 rounded transition-transform ${e.isCollapsed?"-rotate-90":""}`,onClick:r=>{r.stopPropagation(),l(e.id,{isCollapsed:!e.isCollapsed})},children:i("svg",{className:"w-2.5 h-2.5 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:i("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})}),i("div",{className:`w-7 h-7 flex items-center justify-center shrink-0 cursor-pointer rounded ${e.enabled?"text-gray-400":"text-gray-700"}`,onClick:r=>{r.stopPropagation(),v(e.id)},title:e.enabled?"\u70B9\u51FB\u7981\u7528\u56FE\u5C42":"\u70B9\u51FB\u542F\u7528\u56FE\u5C42",children:W("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:[i("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),i("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),i("div",{className:"w-7 h-7 flex items-center justify-center shrink-0",children:Te(e)}),W("div",{className:"flex-1 min-w-0 flex items-center justify-between ml-1 pr-1",children:[he?i("input",{autoFocus:!0,className:"bg-[#1e1e1e] border border-blue-500 text-[11px] px-1 rounded text-white w-full select-text h-5",value:e.name,onChange:r=>l(e.id,{name:r.target.value}),onBlur:()=>{N(null),C(!1)},onKeyDown:r=>r.key==="Enter"&&N(null),onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)}):i("span",{className:`text-[11px] truncate leading-tight flex-1 ${U?"font-bold text-gray-300":"text-gray-400"}`,children:e.name}),!U&&Re>0&&i("span",{className:"text-[9px] bg-black/40 px-1 py-0.5 rounded text-gray-500 font-mono ml-2 shrink-0",children:Re.toLocaleString()})]}),i("div",{className:"w-8 h-8 flex items-center justify-center shrink-0",children:i("button",{onClick:r=>{r.stopPropagation(),f(e.id)},className:"w-full h-full flex items-center justify-center opacity-0 group-hover:opacity-100 hover:text-red-400 text-gray-600 transition-opacity",title:"\u5220\u9664\u56FE\u5C42",children:i("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i("path",{strokeWidth:"3",d:"M6 18L18 6M6 6l12 12"})})})})]}),!U&&b[e.id]&&i("div",{className:"h-[2px] w-full flex space-x-[1px] relative overflow-hidden shrink-0",children:b[e.id].distribution.map((r,te)=>i("div",{className:"flex-1",style:{backgroundColor:q,opacity:Math.max(.05,r*.8)}},te))}),T&&!U&&!e.isCollapsed&&!Q&&W("div",{className:"px-3 pb-3 space-y-2 border-t border-black/10 pt-3 bg-black/10",style:{paddingLeft:`${F*10+20}px`},children:[(e.type==="FILTER"||e.type==="HIGHLIGHT"||e.type==="TRANSFORM")&&i(lt,{value:e.config.query||"",onChange:r=>l(e.id,{config:{...e.config,query:r}}),config:{regex:e.config.regex,caseSensitive:e.config.caseSensitive,wholeWord:e.config.wholeWord},onConfigChange:r=>l(e.id,{config:{...e.config,...r}}),placeholder:e.type==="TRANSFORM"?"\u67E5\u627E\u76EE\u6807...":"\u6B63\u5219\u8868\u8FBE\u5F0F\u6216\u6587\u672C\u6A21\u5F0F...",onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)}),e.type==="FILTER"&&W("div",{className:"flex items-center space-x-2 mt-1",children:[i("button",{onClick:()=>l(e.id,{config:{...e.config,invert:!e.config.invert}}),className:`px-2 py-0.5 rounded text-[9px] font-bold border transition-colors ${e.config.invert?"bg-red-900/40 border-red-500 text-red-200":"bg-transparent border-gray-700 text-gray-500"}`,children:"\u53CD\u8F6C\u8FC7\u6EE4"}),i("span",{className:"text-[9px] text-gray-600 uppercase",children:"\u6392\u9664\u5339\u914D\u9879"})]}),e.type==="TRANSFORM"&&i("input",{className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 text-[11px] rounded text-gray-200 w-full select-text focus:outline-none focus:border-blue-500 h-6",value:e.config.replaceWith||"",onChange:r=>l(e.id,{config:{...e.config,replaceWith:r.target.value}}),placeholder:"\u66FF\u6362\u4E3A...",onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)}),e.type==="RANGE"&&W("div",{className:"flex items-center space-x-2",children:[W("div",{className:"flex-1",children:[i("label",{className:"text-[9px] text-gray-500 uppercase font-bold mb-0.5 block",children:"\u8D77\u59CB\u884C"}),i("input",{type:"number",className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 text-[10px] rounded text-gray-200 w-full select-text focus:outline-none focus:border-blue-500 h-6",value:e.config.from??"",onChange:r=>l(e.id,{config:{...e.config,from:r.target.value===""?void 0:parseInt(r.target.value)}}),placeholder:"1",onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)})]}),W("div",{className:"flex-1",children:[i("label",{className:"text-[9px] text-gray-500 uppercase font-bold mb-0.5 block",children:"\u7ED3\u675F\u884C"}),i("input",{type:"number",className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 text-[10px] rounded text-gray-200 w-full select-text focus:outline-none focus:border-blue-500 h-6",value:e.config.to??"",onChange:r=>l(e.id,{config:{...e.config,to:r.target.value===""?void 0:parseInt(r.target.value)}}),placeholder:"\u6700\u5927",onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)})]})]}),e.type==="LEVEL"&&i("div",{className:"flex flex-wrap gap-1",children:["INFO","WARN","ERROR","DEBUG","FATAL"].map(r=>i("button",{onClick:()=>{let te=e.config.levels||[],ve=te.includes(r)?te.filter(we=>we!==r):[...te,r];l(e.id,{config:{...e.config,levels:ve}})},className:`px-1.5 py-0.5 rounded text-[9px] font-bold border ${e.config.levels?.includes(r)?"bg-red-900/40 border-red-500 text-red-200":"bg-transparent border-gray-700 text-gray-500"}`,children:r},r))}),e.type==="TIME_RANGE"&&W("div",{className:"space-y-3 bg-black/20 p-2 rounded border border-white/5",children:[W("div",{className:"flex flex-col space-y-1",children:[W("div",{className:"flex justify-between items-center",children:[i("label",{className:"text-[9px] text-gray-400 uppercase font-bold",children:"\u65F6\u95F4\u5339\u914D\u5668 (\u6B63\u5219)"}),W("div",{className:"flex space-x-2",children:[i("button",{onClick:()=>l(e.id,{config:{...e.config,timeFormat:"\\d+\\.\\d+"}}),className:"text-[8px] text-blue-400/70 hover:text-blue-400",children:"\u6570\u5B57"}),i("button",{onClick:()=>l(e.id,{config:{...e.config,timeFormat:"\\d{4}-\\d{2}-\\d{2}[T\\s]\\d{2}:\\d{2}:\\d{2}"}}),className:"text-[8px] text-purple-400/70 hover:text-purple-400",children:"ISO\u65E5\u671F"})]})]}),i("input",{className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 text-[10px] rounded text-purple-300 w-full font-mono select-text focus:outline-none focus:border-blue-500 h-6",value:e.config.timeFormat||"",onChange:r=>l(e.id,{config:{...e.config,timeFormat:r.target.value}}),placeholder:"\u4F8B\u5982 (\\d+\\.\\d+) \u6216 ISO \u6A21\u5F0F",onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)})]}),W("div",{className:"grid grid-cols-2 gap-2",children:[W("div",{className:"flex flex-col space-y-1",children:[i("label",{className:"text-[9px] text-gray-400 uppercase font-bold",children:"\u8D77\u59CB\u65F6\u95F4/\u503C"}),i("input",{className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 text-[10px] rounded text-gray-200 w-full select-text focus:outline-none focus:border-blue-500 h-6",value:e.config.startTime||"",onChange:r=>l(e.id,{config:{...e.config,startTime:r.target.value}}),placeholder:"0.0 \u6216 \u65E5\u671F",onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)})]}),W("div",{className:"flex flex-col space-y-1",children:[i("label",{className:"text-[9px] text-gray-400 uppercase font-bold",children:"\u7ED3\u675F\u65F6\u95F4/\u503C"}),i("input",{className:"bg-[#1e1e1e] border border-[#444] px-2 py-1 text-[10px] rounded text-gray-200 w-full select-text focus:outline-none focus:border-blue-500 h-6",value:e.config.endTime||"",onChange:r=>l(e.id,{config:{...e.config,endTime:r.target.value}}),placeholder:"\u6700\u5927 \u6216 \u65E5\u671F",onMouseDown:r=>r.stopPropagation(),onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)})]})]}),i("p",{className:"text-[8px] text-gray-500 italic px-1",children:"\u63D0\u793A: \u4F7F\u7528\u6B63\u5219\u62EC\u53F7 () \u6355\u83B7\u7279\u5B9A\u7684\u65F6\u95F4\u90E8\u5206\u3002"})]}),e.type==="HIGHLIGHT"&&W("div",{className:"flex items-center space-x-2",children:[i("input",{type:"color",value:e.config.color||"#3b82f6",onChange:r=>l(e.id,{config:{...e.config,color:r.target.value}}),className:"w-5 h-5 bg-transparent border-none cursor-pointer p-0",title:"\u9AD8\u4EAE\u989C\u8272"}),i("input",{type:"range",min:"0",max:"100",value:e.config.opacity||100,onChange:r=>l(e.id,{config:{...e.config,opacity:parseInt(r.target.value)}}),className:"flex-1 h-1 bg-[#444] rounded appearance-none accent-blue-500",title:"\u900F\u660E\u5EA6"})]})]})]},e.id)},De=(e=void 0,F=0)=>n.filter(T=>T.groupId===e).map(T=>{let H=T.type==="FOLDER";return W($t.Fragment,{children:[Ae(T,F),H&&!T.isCollapsed&&De(T.id,F+1)]},T.id)}),Fe=()=>{if(!G||!b[G])return null;let e=n.find(Q=>Q.id===G);if(!e)return null;let F=b[G],T=e.config.color||"#3b82f6",H={position:"fixed",left:O.x,top:O.y,zIndex:1e3,pointerEvents:"none"};return W("div",{style:H,className:"bg-[#2d2d30] border border-[#454545] shadow-2xl rounded p-3 w-48 text-[11px] text-[#cccccc] flex flex-col space-y-2 backdrop-blur-md bg-opacity-95",children:[W("div",{className:"flex items-center justify-between border-b border-white/5 pb-1",children:[i("span",{className:"font-bold text-gray-400 truncate max-w-[100px]",children:e.name}),i("span",{className:"text-blue-400 font-mono",children:F.count.toLocaleString()})]}),i("div",{className:"flex items-end space-x-[1px] h-12 bg-black/20 p-1 rounded mt-1",children:F.distribution.map((Q,U)=>i("div",{className:"flex-1 transition-all duration-300",style:{height:`${Math.max(4,Q*100)}%`,backgroundColor:T,opacity:Math.max(.2,Q)}},U))})]})};return W("div",{className:"flex flex-col pb-10",children:[De(),i(Fe,{})]})};import{useState as Bt,useEffect as Ot,useRef as Gt}from"react";import{jsx as E,jsxs as Z}from"react/jsx-runtime";var ut=({onSearch:n,config:b,setConfig:p,matchCount:o=0,currentIndex:g=0,onNavigate:f})=>{let[v,l]=Bt(""),w=Gt(null);Ot(()=>{w.current?.focus()},[]);let L=m=>{m.key==="Enter"?(m.preventDefault(),m.shiftKey?f?.("prev"):f?.("next")):m.key==="Escape"&&(l(""),n(""))},x=()=>{l(""),n(""),w.current?.focus()};return Z("div",{className:"p-4 flex flex-col h-full overflow-hidden select-none",children:[Z("div",{className:"flex items-center justify-between mb-4",children:[E("h2",{className:"text-[11px] uppercase tracking-wider font-bold opacity-70",children:"\u641C\u7D22"}),o>0&&Z("div",{className:"flex items-center space-x-1",children:[E("span",{className:"text-[10px] text-gray-500 font-mono",children:o>0?`${g} / ${o}`:"\u65E0\u7ED3\u679C"}),Z("div",{className:"flex ml-2 border-l border-white/10 pl-2",children:[E("button",{onClick:()=>f?.("prev"),className:"p-1 hover:bg-[#3c3c3c] rounded text-gray-400 hover:text-white transition-colors",title:"\u4E0A\u4E00\u4E2A\u5339\u914D\u9879 (Shift+Enter)",children:E("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M5 15l7-7 7 7"})})}),E("button",{onClick:()=>f?.("next"),className:"p-1 hover:bg-[#3c3c3c] rounded text-gray-400 hover:text-white transition-colors",title:"\u4E0B\u4E00\u4E2A\u5339\u914D\u9879 (Enter)",children:E("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 9l-7 7-7-7"})})})]})]})]}),E("div",{className:"relative group mb-4",children:Z("div",{className:`relative flex items-center bg-[#3c3c3c] border transition-all rounded overflow-hidden ${v?"border-blue-500/50":"border-transparent"}`,children:[E("input",{ref:w,type:"text",value:v,onChange:m=>{l(m.target.value),n(m.target.value)},onKeyDown:L,placeholder:"\u641C\u7D22\u65E5\u5FD7...",className:"w-full bg-transparent text-white text-xs px-2 py-1.5 focus:outline-none pr-28"}),Z("div",{className:"absolute right-1 flex items-center space-x-0.5",children:[v&&E("button",{onClick:x,className:"w-5 h-5 flex items-center justify-center text-gray-500 hover:text-white",title:"\u6E05\u9664",children:E("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E("path",{strokeWidth:"3",d:"M6 18L18 6M6 6l12 12"})})}),E("button",{onClick:()=>p(m=>({...m,caseSensitive:!m.caseSensitive})),className:`w-6 h-6 flex items-center justify-center rounded text-[10px] transition-colors ${b.caseSensitive?"bg-blue-600 text-white shadow-inner":"text-gray-400 hover:bg-[#555]"}`,title:"\u533A\u5206\u5927\u5C0F\u5199",children:"Aa"}),E("button",{onClick:()=>p(m=>({...m,wholeWord:!m.wholeWord})),className:`w-6 h-6 flex items-center justify-center rounded text-[10px] transition-colors ${b.wholeWord?"bg-blue-600 text-white shadow-inner":"text-gray-400 hover:bg-[#555]"}`,title:"\u5168\u5B57\u5339\u914D",children:E("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E("path",{strokeWidth:"2.5",d:"M3 12h18M3 6h18M3 18h18"})})}),E("button",{onClick:()=>p(m=>({...m,regex:!m.regex})),className:`w-6 h-6 flex items-center justify-center rounded text-[10px] transition-colors ${b.regex?"bg-blue-600 text-white shadow-inner":"text-gray-400 hover:bg-[#555]"}`,title:"\u4F7F\u7528\u6B63\u5219\u8868\u8FBE\u5F0F",children:".*"})]})]})}),Z("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:[E("div",{className:"text-[10px] opacity-40 uppercase font-bold mb-3 tracking-tighter",children:"\u641C\u7D22\u6280\u5DE7"}),Z("div",{className:"space-y-4",children:[Z("div",{className:"group",children:[Z("div",{className:"flex items-center text-[11px] text-blue-400 font-bold mb-1",children:[E("svg",{className:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E("path",{d:"M13 10V3L4 14h7v7l9-11h-7z",strokeWidth:"2"})}),"\u5FEB\u6377\u952E\u652F\u6301"]}),Z("p",{className:"text-[10px] text-gray-500 leading-relaxed px-4.5",children:["\u6309 ",E("kbd",{className:"bg-[#333] px-1 rounded border border-white/10 font-mono text-gray-300",children:"Enter"})," \u8DF3\u8F6C\u5230\u4E0B\u4E00\u4E2A\u7ED3\u679C\u3002\u4F7F\u7528 ",E("kbd",{className:"bg-[#333] px-1 rounded border border-white/10 font-mono text-gray-300",children:"Shift+Enter"})," \u8DF3\u8F6C\u5230\u4E0A\u4E00\u4E2A\u3002"]})]}),Z("div",{className:"group",children:[Z("div",{className:"flex items-center text-[11px] text-yellow-500 font-bold mb-1",children:[E("svg",{className:"w-3 h-3 mr-1.5",fill:"currentColor",viewBox:"0 0 24 24",children:E("path",{d:"M12 2L2 7l10 5 10-5-10-5z"})}),"\u5168\u5C40\u9AD8\u4EAE"]}),E("p",{className:"text-[10px] text-gray-500 leading-relaxed px-4.5",children:"\u5339\u914D\u9879\u5C06\u5728\u6240\u6709\u65E5\u5FD7\u4E2D\u4EE5\u9EC4\u8272\u7A81\u51FA\u663E\u793A\uFF0C\u5305\u62EC\u8FC7\u6EE4\u540E\u7684\u89C6\u56FE\u3002\u975E\u6301\u4E45\u6027\u3002"})]}),E("div",{className:"p-3 bg-blue-500/5 border border-blue-500/10 rounded-lg",children:Z("p",{className:"text-[10px] text-blue-400 italic flex items-start",children:[E("svg",{className:"w-3 h-3 mr-1.5 mt-0.5 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E("path",{strokeWidth:"2.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"\u4ECE\u56FE\u5C42\u9762\u677F\u4F7F\u7528\u201C\u9AD8\u4EAE\u56FE\u5C42\u201D\u53EF\u521B\u5EFA\u6C38\u4E45\u7684\u591A\u989C\u8272\u89C4\u5219\u3002"]})})]})]})]})};import{useRef as Vt,useEffect as jt}from"react";import{jsx as K,jsxs as Be}from"react/jsx-runtime";var pt=({query:n,onQueryChange:b,config:p,onConfigChange:o,matchCount:g,currentMatch:f,onNavigate:v,onClose:l})=>{let w=Vt(null);return jt(()=>{w.current?.focus(),w.current?.select()},[]),Be("div",{className:"absolute top-2 right-8 z-30 bg-[#252526] border border-[#454545] shadow-2xl rounded flex items-center p-1 space-x-1 animate-in slide-in-from-top-2 duration-150",children:[Be("div",{className:"flex items-center bg-[#3c3c3c] border border-blue-500/30 rounded overflow-hidden min-w-[280px]",children:[K("input",{ref:w,type:"text",value:n,onChange:x=>b(x.target.value),onKeyDown:x=>{x.key==="Enter"?(x.preventDefault(),v(x.shiftKey?"prev":"next")):x.key==="Escape"&&l()},placeholder:"\u67E5\u627E",className:"bg-transparent text-white text-xs px-2 py-1 w-full focus:outline-none"}),Be("div",{className:"flex items-center pr-1 bg-[#3c3c3c]",children:[K("button",{onClick:()=>o(x=>({...x,caseSensitive:!x.caseSensitive})),className:`w-5 h-5 flex items-center justify-center rounded text-[10px] transition-colors ${p.caseSensitive?"bg-blue-600 text-white":"text-gray-400 hover:bg-[#555]"}`,title:"\u533A\u5206\u5927\u5C0F\u5199 (Alt+C)",children:"Aa"}),K("button",{onClick:()=>o(x=>({...x,wholeWord:!x.wholeWord})),className:`w-5 h-5 flex items-center justify-center rounded text-[10px] transition-colors ${p.wholeWord?"bg-blue-600 text-white":"text-gray-400 hover:bg-[#555]"}`,title:"\u5168\u5B57\u5339\u914D (Alt+W)",children:K("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K("path",{strokeWidth:"3",d:"M3 12h18M3 6h18M3 18h18"})})}),K("button",{onClick:()=>o(x=>({...x,regex:!x.regex})),className:`w-5 h-5 flex items-center justify-center rounded text-[10px] transition-colors ${p.regex?"bg-blue-600 text-white":"text-gray-400 hover:bg-[#555]"}`,title:"\u4F7F\u7528\u6B63\u5219\u8868\u8FBE\u5F0F (Alt+R)",children:".*"})]})]}),K("div",{className:"flex items-center px-2 border-r border-white/10 text-[10px] text-gray-500 font-mono min-w-[60px] justify-center",children:g>0?`${f} / ${g}`:"\u65E0\u7ED3\u679C"}),Be("div",{className:"flex items-center",children:[K("button",{onClick:()=>v("prev"),className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-white hover:bg-[#3c3c3c] rounded transition-colors",title:"\u4E0A\u4E00\u4E2A\u5339\u914D\u9879 (Shift+Enter)",children:K("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M5 15l7-7 7 7"})})}),K("button",{onClick:()=>v("next"),className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-white hover:bg-[#3c3c3c] rounded transition-colors",title:"\u4E0B\u4E00\u4E2A\u5339\u914D\u9879 (Enter)",children:K("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 9l-7 7-7-7"})})}),K("button",{onClick:l,className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-white hover:bg-[#3c3c3c] rounded transition-colors ml-1",title:"\u5173\u95ED (Escape)",children:K("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:K("path",{strokeWidth:"3",d:"M6 18L18 6M6 6l12 12"})})})]})]})};import{useState as _t,useEffect as Kt,useRef as Jt}from"react";import{jsx as Ne,jsxs as Ie}from"react/jsx-runtime";var gt=({totalLines:n,onGo:b,onClose:p})=>{let[o,g]=_t(""),f=Jt(null);Kt(()=>{f.current?.focus()},[]);let v=w=>{if(w.key==="Enter"){let L=parseInt(o,10);!isNaN(L)&&L>0&&L<=n&&b(L)}else w.key==="Escape"&&p()},l=!o||parseInt(o,10)>0&&parseInt(o,10)<=n;return Ne("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 z-40 w-[400px] animate-in slide-in-from-top-4 duration-150",children:Ie("div",{className:"bg-[#252526] shadow-2xl rounded-b border border-t-0 border-[#454545] p-2",children:[Ie("div",{className:`flex items-center bg-[#3c3c3c] border rounded overflow-hidden transition-colors ${l?"border-blue-500/50":"border-red-500"}`,children:[Ne("div",{className:"px-2 text-gray-500 text-xs select-none",children:":"}),Ne("input",{ref:f,type:"text",value:o,onChange:w=>g(w.target.value.replace(/[^0-9]/g,"")),onKeyDown:v,placeholder:`\u8F93\u5165\u884C\u53F7 (1 \u5230 ${n.toLocaleString()})`,className:"bg-transparent text-white text-xs px-1 py-1.5 w-full focus:outline-none"})]}),!l&&Ie("div",{className:"text-[10px] text-red-400 mt-1 px-1",children:["\u884C\u53F7\u5FC5\u987B\u5728 1 \u5230 ",n.toLocaleString()," \u4E4B\u95F4"]}),Ie("div",{className:"mt-2 flex justify-between items-center px-1",children:[Ne("span",{className:"text-[10px] text-gray-500 uppercase tracking-tighter font-bold",children:"\u8DF3\u8F6C\u5230\u884C"}),Ie("div",{className:"flex space-x-2",children:[Ne("span",{className:"text-[9px] text-gray-600 bg-black/20 px-1 rounded flex items-center",children:"ENTER \u8DF3\u8F6C"}),Ne("span",{className:"text-[9px] text-gray-600 bg-black/20 px-1 rounded flex items-center",children:"ESC \u53D6\u6D88"})]})]})]})})};import{jsx as Y,jsxs as pe}from"react/jsx-runtime";var ft=({presets:n,onApply:b,onDelete:p})=>pe("div",{className:"p-4 flex flex-col h-full overflow-hidden",children:[Y("div",{className:"flex items-center justify-between mb-4",children:Y("h2",{className:"text-[11px] uppercase tracking-wider font-bold opacity-70",children:"\u5DF2\u5B58\u9884\u8BBE"})}),pe("div",{className:"flex-1 overflow-y-auto space-y-2 custom-scrollbar pr-1",children:[n.map(o=>{let g=o.name==="\u9ED8\u8BA4\u9884\u8BBE"||o.name==="Default";return pe("div",{className:`group relative border rounded p-3 transition-all cursor-pointer shadow-sm
                ${g?"bg-blue-900/10 border-blue-500/40 hover:bg-blue-900/20":"bg-[#3c3c3c] border-[#444] hover:border-blue-500 hover:bg-[#444]"}`,onClick:()=>b(o),children:[Y("div",{className:"flex items-center justify-between mb-1",children:pe("div",{className:`text-xs font-bold flex items-center ${g?"text-blue-400":"text-gray-200 group-hover:text-blue-400"}`,children:[o.name,g&&Y("span",{className:"ml-2 px-1 text-[8px] bg-blue-600 text-white rounded font-black tracking-tighter",children:"\u7CFB\u7EDF"})]})}),pe("div",{className:"text-[10px] text-gray-500 uppercase flex items-center space-x-2",children:[pe("span",{children:[o.layers.length," \u4E2A\u56FE\u5C42"]}),Y("span",{children:"\u2022"}),pe("span",{children:[o.layers.filter(f=>f.type==="FOLDER").length," \u4E2A\u6587\u4EF6\u5939"]})]}),!g&&Y("button",{onClick:f=>{f.stopPropagation(),p(o.id)},className:"absolute top-2 right-2 p-1 text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",title:"\u5220\u9664\u9884\u8BBE",children:Y("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Y("path",{strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),g&&Y("div",{className:"absolute top-2 right-2 text-blue-500/40 opacity-0 group-hover:opacity-100 transition-opacity",children:Y("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:Y("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})})})]},o.id)}),n.length===0&&Y("div",{className:"text-center py-10 text-gray-600 italic text-[11px]",children:"\u5C1A\u672A\u4FDD\u5B58\u4EFB\u4F55\u9884\u8BBE\u3002"})]}),Y("div",{className:"mt-4 p-2 bg-blue-500/5 border border-blue-500/10 rounded",children:pe("p",{className:"text-[9px] text-gray-500 leading-relaxed",children:[Y("span",{className:"text-blue-400 font-bold",children:"\u4E13\u4E1A\u63D0\u793A:"})," \u66F4\u65B0 ",Y("span",{className:"text-blue-400 font-bold",children:"\u9ED8\u8BA4\u9884\u8BBE"})," \u53EF\u66F4\u6539\u60A8\u7684\u542F\u52A8\u73AF\u5883\u3002\u7CFB\u7EDF\u9884\u8BBE\u662F\u6C38\u4E45\u6027\u7684\uFF0C\u4F46\u53EF\u4EE5\u5B8C\u5168\u81EA\u5B9A\u4E49\u3002"]})})]});import{jsx as B,jsxs as se}from"react/jsx-runtime";var mt=({fileName:n,fileSize:b,onFileSelect:p})=>se("div",{className:"flex flex-col h-full",children:[B("div",{className:"p-3 border-b border-[#111] flex justify-between items-center bg-[#2d2d2d] shrink-0",children:B("h2",{className:"text-[10px] uppercase font-black opacity-40 tracking-wider",children:"\u8D44\u6E90\u7BA1\u7406\u5668"})}),se("div",{className:"flex-1 overflow-y-auto",children:[se("div",{className:"mb-4",children:[se("div",{className:"flex items-center px-4 py-1 bg-[#37373d] text-[11px] font-bold text-gray-400 uppercase tracking-tight cursor-default",children:[B("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:B("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),"\u6253\u5F00\u7684\u7F16\u8F91\u5668"]}),B("div",{className:"px-6 py-2",children:n?se("div",{className:"flex items-center text-xs text-blue-400 hover:bg-[#2a2d2e] p-1 rounded cursor-pointer",children:[B("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:B("path",{strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),n]}):B("div",{className:"text-[11px] text-gray-600 italic",children:"\u672A\u6253\u5F00\u4EFB\u4F55\u6587\u4EF6"})})]}),se("div",{children:[se("div",{className:"flex items-center px-4 py-1 bg-[#37373d] text-[11px] font-bold text-gray-400 uppercase tracking-tight cursor-default",children:[B("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:B("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),"\u672C\u5730\u5DE5\u4F5C\u533A"]}),B("div",{className:"px-4 py-2 space-y-2",children:n?se("div",{className:"text-[11px] space-y-1",children:[se("div",{className:"flex justify-between text-gray-500",children:[B("span",{children:"\u5927\u5C0F:"}),B("span",{className:"text-gray-300",children:(g=>{if(g===0)return"0 B";let f=1024,v=["B","KB","MB","GB"],l=Math.floor(Math.log(g)/Math.log(f));return parseFloat((g/Math.pow(f,l)).toFixed(1))+" "+v[l]})(b)})]}),se("div",{className:"flex justify-between text-gray-500",children:[B("span",{children:"\u72B6\u6001:"}),B("span",{className:"text-green-500",children:"\u5DF2\u52A0\u8F7D"})]}),B("div",{className:"pt-4",children:B("button",{onClick:p,className:"w-full text-center text-blue-500 hover:text-blue-400 border border-blue-500/30 py-1 rounded transition-colors",children:"\u6253\u5F00\u53E6\u4E00\u4E2A..."})})]}):se("div",{className:"p-4 border border-dashed border-gray-700 rounded text-center",children:[B("p",{className:"text-[10px] text-gray-500 mb-2",children:"\u5C1A\u672A\u6253\u5F00\u65E5\u5FD7\u6587\u4EF6\u3002"}),B("button",{onClick:p,className:"bg-blue-600 hover:bg-blue-500 text-white text-[11px] px-3 py-1 rounded shadow-lg transition-colors",children:"\u6253\u5F00\u6587\u4EF6"})]})})]})]})]});import{jsx as y,jsxs as R}from"react/jsx-runtime";var xt=()=>y("div",{className:"p-8 flex flex-col h-full overflow-y-auto custom-scrollbar bg-[#1e1e1e] text-gray-300 select-text",children:R("div",{className:"max-w-4xl mx-auto",children:[R("header",{className:"mb-10 border-b border-white/10 pb-6",children:[R("h2",{className:"text-2xl font-black text-blue-400 mb-2 flex items-center tracking-tight",children:[y("svg",{className:"w-8 h-8 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y("path",{strokeWidth:"2.5",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"\u5F00\u53D1\u8005\u4E2D\u5FC3: \u56FE\u5C42\u67B6\u6784\u4E0E Linux \u90E8\u7F72"]}),R("p",{className:"text-sm text-gray-500 leading-relaxed",children:["\u6B22\u8FCE\u9605\u8BFB LogLayer Pro \u6269\u5C55\u6307\u5357\u3002\u6211\u4EEC\u7684\u5E94\u7528\u91C7\u7528\u4E86\u53D7 Photoshop \u8C03\u6574\u56FE\u5C42\u542F\u53D1\u7684 ",y("b",{children:"\u975E\u7834\u574F\u6027\u7BA1\u9053 (Non-Destructive Pipeline)"}),"\u3002 \u6BCF\u4E2A\u56FE\u5C42\u90FD\u4F5C\u4E3A\u4E00\u4E2A\u5904\u7406\u6570\u636E\u6D41\u7684\u7EAF\u51FD\u6570\u8FD0\u884C\u3002"]})]}),R("div",{className:"space-y-12 pb-20",children:[R("section",{className:"bg-green-900/10 border border-green-500/20 p-6 rounded-lg",children:[R("h3",{className:"text-sm font-black text-green-400 mb-4 flex items-center uppercase tracking-widest",children:[y("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y("path",{strokeWidth:"2.5",d:"M5 12h14M5 12l4-4m-4 4l4 4"})}),"Linux \u65E0 NPM \u73AF\u5883\u90E8\u7F72\u6307\u5357"]}),R("div",{className:"space-y-4 text-xs text-gray-400",children:[R("p",{children:["\u9488\u5BF9\u6CA1\u6709 Node.js \u73AF\u5883\u7684 Linux \u670D\u52A1\u5668\uFF0C\u6211\u4EEC\u63D0\u4F9B\u4E86\u4E00\u4E2A\u81EA\u52A8\u5316\u6253\u5305\u811A\u672C ",y("code",{className:"text-green-400",children:"package.sh"}),"\u3002"]}),R("div",{className:"bg-black/40 p-4 rounded font-mono text-[11px] border border-white/5 space-y-2",children:[y("div",{className:"text-gray-500",children:"# \u5728\u5F00\u53D1\u673A\uFF08\u6709\u7F51\u7EDC\uFF09\u8FD0\u884C"}),y("div",{className:"text-white",children:"bash package.sh"}),y("div",{className:"text-gray-500",children:"# \u8FD9\u5C06\u751F\u6210 dist_linux \u6587\u4EF6\u5939"}),y("div",{className:"text-white",children:"scp -r dist_linux user@your-linux-server:~/"}),y("div",{className:"text-gray-500",children:"# \u5728\u76EE\u6807 Linux \u4E0A\u542F\u52A8"}),y("div",{className:"text-white",children:"cd dist_linux && ./run.sh"})]}),R("ul",{className:"list-disc pl-5 space-y-2",children:[R("li",{children:[y("strong",{className:"text-gray-200",children:"\u81EA\u5305\u542B\u7F16\u8BD1\u5668\uFF1A"})," \u811A\u672C\u4F1A\u81EA\u52A8\u4E0B\u8F7D ",y("code",{className:"text-blue-400",children:"esbuild"})," \u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u4E0D\u4F9D\u8D56\u7CFB\u7EDF\u4E2D\u7684 Node.js \u6216 NPM\u3002"]}),R("li",{children:[y("strong",{className:"text-gray-200",children:"\u901A\u7528\u542F\u52A8\u5668\uFF1A"})," ",y("code",{className:"text-yellow-500",children:"run.sh"})," \u4F7F\u7528 Linux \u9884\u88C5\u7684 Python \u542F\u52A8 Web \u670D\u52A1\u3002"]}),R("li",{children:[y("strong",{className:"text-gray-200",children:"\u9759\u6001\u8D44\u6E90\u4F18\u5316\uFF1A"})," \u6253\u5305\u540E\u7684 ",y("code",{className:"text-teal-400",children:"bundle.js"})," \u5DF2\u8FC7\u6DF7\u6DC6\u548C\u538B\u7F29\uFF0C\u9002\u5408\u5904\u7406 GB \u7EA7\u65E5\u5FD7\u65F6\u7684\u5185\u5B58\u6548\u7387\u3002"]})]})]})]}),R("section",{className:"bg-[#252526] p-6 rounded-lg border border-white/5 shadow-xl",children:[R("h3",{className:"text-xs font-black uppercase text-blue-500 mb-4 tracking-widest flex items-center",children:[y("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"\u6838\u5FC3\u6982\u5FF5\uFF1A\u5904\u7406\u7BA1\u9053"]}),y("div",{className:"flex items-start space-x-6",children:R("div",{className:"flex-1 text-xs leading-relaxed space-y-3",children:[R("p",{children:["\u65E5\u5FD7\u6D41\u7ECF\u4E00\u7CFB\u5217\u542F\u7528\u7684\u56FE\u5C42\u3002 ",y("span",{className:"text-blue-400 font-mono",children:"\u56FE\u5C42 N"})," \u7684\u8F93\u51FA\u662F",y("span",{className:"text-blue-400 font-mono",children:"\u56FE\u5C42 N+1"})," \u7684\u8F93\u5165\u3002"]}),y("div",{className:"bg-black/40 p-3 rounded font-mono text-[10px] text-gray-400 border border-white/5",children:"\u539F\u59CB\u65E5\u5FD7 (\u5B57\u7B26\u4E32) \u2192 \u5BF9\u8C61\u5316 \u2192 [ \u8FC7\u6EE4 ] \u2192 [ \u8F6C\u6362 ] \u2192 [ \u9AD8\u4EAE ] \u2192 \u865A\u62DF\u5316\u89C6\u56FE"})]})})]}),R("section",{className:"space-y-6",children:[y("h3",{className:"text-sm font-black uppercase text-gray-500 tracking-widest",children:"\u6269\u5C55\u5DE5\u4F5C\u6D41"}),R("div",{className:"relative pl-8 border-l-2 border-white/5 space-y-10",children:[R("div",{className:"relative",children:[y("div",{className:"absolute -left-[41px] top-0 w-6 h-6 rounded-full bg-[#333] border-2 border-[#1e1e1e] flex items-center justify-center text-[10px] font-bold",children:"1"}),y("h4",{className:"text-xs font-bold text-gray-200 mb-2",children:"\u5B9A\u4E49 Schema"}),R("p",{className:"text-[11px] text-gray-500 mb-3",children:["\u5728 ",y("code",{className:"text-teal-400",children:"types.ts"})," \u4E2D\u6DFB\u52A0\u65B0\u7684\u56FE\u5C42\u7C7B\u578B\u548C\u914D\u7F6E\u952E\u3002"]}),y("pre",{className:"bg-black/50 p-4 rounded font-mono text-[11px] text-teal-400 border border-white/5",children:`export enum LayerType {
  MY_CUSTOM_LOGIC = 'MY_CUSTOM_LOGIC',
}

export interface LayerConfig {
  myParameter?: string; // \u5728\u6B64\u5904\u6DFB\u52A0\u81EA\u5B9A\u4E49\u5B57\u6BB5
}`})]}),R("div",{className:"relative",children:[y("div",{className:"absolute -left-[41px] top-0 w-6 h-6 rounded-full bg-[#333] border-2 border-[#1e1e1e] flex items-center justify-center text-[10px] font-bold",children:"2"}),y("h4",{className:"text-xs font-bold text-gray-200 mb-2",children:"\u5B9E\u73B0\u5904\u7406\u5668 (Processor)"}),R("p",{className:"text-[11px] text-gray-500 mb-3",children:["\u521B\u5EFA ",y("code",{className:"text-blue-400",children:"processors/myProcessor.ts"}),"\u3002\u8FD9\u662F\u6267\u884C\u6838\u5FC3\u8BA1\u7B97\u7684\u5730\u65B9\u3002"]}),y("pre",{className:"bg-black/50 p-4 rounded font-mono text-[11px] text-blue-300 border border-white/5 overflow-x-auto",children:`import { LogProcessor, LogLine } from '../types';

export const myProcessor: LogProcessor = (lines, layer, chunkSize) => {
  const { myParameter } = layer.config;
  const distribution = new Array(20).fill(0);
  let matchCount = 0;

  const processedLines: LogLine[] = [];
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    if (line.content.includes(myParameter)) {
      matchCount++;
      distribution[Math.floor(i / chunkSize)]++;
      processedLines.push(line);
    }
  }

  return { processedLines, stats: { count: matchCount, distribution } };
};`})]})]})]}),R("section",{className:"bg-blue-900/10 border border-blue-500/20 p-6 rounded-lg",children:[R("h3",{className:"text-sm font-black text-blue-400 mb-4 flex items-center uppercase tracking-widest",children:[y("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y("path",{strokeWidth:"2.5",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"\u9AD8\u6027\u80FD\u5F00\u53D1\u6307\u5357 (\u5927\u6570\u636E\u91CF)"]}),R("ul",{className:"text-xs space-y-3 text-gray-400 list-disc pl-4",children:[R("li",{children:[y("strong",{className:"text-gray-200",children:"\u5904\u7406\u8D85\u8FC7 100 \u4E07\u884C\u65F6\u907F\u514D\u4F7F\u7528 Array.map/filter\uFF1A"})," \u5BF9\u4E8E\u6D77\u91CF\u65E5\u5FD7\uFF0C\u8BF7\u4F7F\u7528\u7ECF\u5178\u7684 ",y("code",{className:"text-yellow-600",children:"for(let i=0...)"})," \u5FAA\u73AF\u3002"]}),R("li",{children:[y("strong",{className:"text-gray-200",children:"\u975E\u963B\u585E UI\uFF1A"})," \u5728\u5904\u7406\u5668\u5185\u90E8\u4F7F\u7528 ",y("code",{className:"text-blue-400",children:"taskId"})," \u68C0\u67E5\uFF0C\u5982\u679C\u7528\u6237\u4E2D\u9014\u66F4\u6539\u53C2\u6570\uFF0C\u5219\u4E2D\u6B62\u8FD0\u884C\u65F6\u95F4\u8FC7\u957F\u7684\u4EFB\u52A1\u3002"]})]})]}),y("footer",{className:"text-center pt-10 opacity-30",children:y("div",{className:"text-[10px] font-mono tracking-widest uppercase",children:"LogLayer Pro \u5F15\u64CE v2.4 \u2022 \u975E\u7834\u574F\u6027\u65E5\u5FD7\u5206\u6790\u7CFB\u7EDF"})})]})]})});import{jsx as Le,jsxs as ke}from"react/jsx-runtime";var ht=({lines:n,totalLines:b,size:p,isProcessing:o})=>{let g=f=>{if(f===0)return"0 B";let v=1024,l=["B","KB","MB","GB"],w=Math.floor(Math.log(f)/Math.log(v));return parseFloat((f/Math.pow(v,w)).toFixed(1))+" "+l[w]};return ke("div",{className:"h-6 bg-blue-700 text-white flex items-center justify-between px-3 text-[11px] font-medium shrink-0",children:[ke("div",{className:"flex items-center space-x-4",children:[ke("div",{className:"flex items-center space-x-1 cursor-pointer hover:bg-blue-600 px-1 rounded",children:[Le("svg",{className:`w-3 h-3 ${o?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Le("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),Le("span",{children:o?"\u6B63\u5728\u6D41\u5F0F\u5904\u7406\u6570\u636E...":"\u5C31\u7EEA"})]}),Le("div",{className:"hover:bg-blue-600 px-1 cursor-pointer",children:"UTF-8"})]}),ke("div",{className:"flex items-center space-x-6",children:[ke("div",{children:["\u53EF\u89C1: ",n.toLocaleString()," / \u603B\u8BA1: ",b.toLocaleString()]}),ke("div",{children:["\u5927\u5C0F: ",g(p)]}),Le("div",{className:"hover:bg-blue-600 px-1 cursor-pointer",children:"Tab \u7F29\u8FDB: 2"}),Le("div",{className:"hover:bg-blue-600 px-1 cursor-pointer",children:"\u884C 1, \u5217 1"})]})]})};var bt=(n,b,p)=>{let{query:o,regex:g,caseSensitive:f,invert:v,wholeWord:l}=b.config,w=new Array(20).fill(0),L=0;if(!o)return{processedLines:n,stats:{count:0,distribution:w}};let x=null;try{let h=g?o:o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");l&&(h=`\\b${h}\\b`),x=new RegExp(h,f?"":"i")}catch{return{processedLines:n,stats:{count:0,distribution:w}}}let m=[],P=n.length;for(let h=0;h<P;h++){let k=n[h],S=typeof k=="string"?k:k.content,M=x.test(S);(v?!M:M)&&(L++,w[Math.floor(h/p)]++,typeof k=="string"?m.push({index:h,content:k}):m.push(k))}return{processedLines:m,stats:{count:L,distribution:w}}};var vt=(n,b,p)=>{let{query:o,regex:g,caseSensitive:f,wholeWord:v,color:l="#3b82f6",opacity:w=100}=b.config,L=new Array(20).fill(0),x=0;if(!o)return{processedLines:n,stats:{count:0,distribution:L}};let m;try{let h=g?o:o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");v&&(h=`\\b${h}\\b`),m=new RegExp(h,f?"g":"gi")}catch{return{processedLines:n,stats:{count:0,distribution:L}}}return{processedLines:n.map((h,k)=>{let S=Array.from(h.content.matchAll(m));if(S.length>0){x+=S.length,L[Math.floor(k/p)]++;let M=S.map(N=>({start:N.index||0,end:(N.index||0)+N[0].length,color:l,opacity:w}));return{...h,highlights:[...h.highlights||[],...M]}}return h}),stats:{count:x,distribution:L}}};var wt=(n,b,p)=>{let{from:o,to:g}=b.config,f=new Array(20).fill(0),v=0;return o===void 0&&g===void 0?{processedLines:n,stats:{count:0,distribution:f}}:{processedLines:n.filter((w,L)=>{let x=w.index+1,m=o!==void 0?o:1,P=g!==void 0?g:1/0,h=x>=m&&x<=P;return h&&(v++,f[Math.floor(L/p)]++),h}),stats:{count:v,distribution:f}}};var yt=(n,b,p)=>{let{startTime:o,endTime:g,timeFormat:f}=b.config,v=new Array(20).fill(0),l=0;if(!o&&!g)return{processedLines:n,stats:{count:0,distribution:v}};let w=h=>{if(!h)return NaN;let k=h.trim();return/^-?\d*(\.\d+)?$/.test(k)?parseFloat(k):new Date(k).getTime()},L=o?w(o):-1/0,x=g?w(g):1/0,m;try{m=f?new RegExp(f):/(?:\d{4}-\d{2}-\d{2}[T\s]\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?)|(?:\d+\.\d+)/}catch{m=/\d+\.\d+/}return{processedLines:n.filter((h,k)=>{let S=h.content.match(m);if(!S)return!1;let M=S[1]||S[0];if(!M)return!1;let N=M.replace(/[\[\]]/g,"").trim(),I;if(/^-?\d*(\.\d+)?$/.test(N))I=parseFloat(N);else{let G=N.replace(/^(\d{4}-\d{2}-\d{2})\s/,"$1T");I=new Date(G).getTime()}if(isNaN(I))return!1;let C=I>=L&&I<=x;return C&&(l++,v[Math.floor(k/p)]++),C}),stats:{count:l,distribution:v}}};var Nt=(n,b,p)=>{let{levels:o=[]}=b.config,g=new Array(20).fill(0),f=0;if(!o.length)return{processedLines:n,stats:{count:0,distribution:g}};let v=new RegExp(`\\b(${o.join("|")})\\b`,"i");return{processedLines:n.filter((w,L)=>{let x=v.test(w.content);return x&&(f++,g[Math.floor(L/p)]++),x}),stats:{count:f,distribution:g}}};var Lt=(n,b,p)=>{let{query:o,replaceWith:g="",regex:f=!0,caseSensitive:v=!1,wholeWord:l=!1}=b.config,w=new Array(20).fill(0),L=0;if(!o)return{processedLines:n,stats:{count:0,distribution:w}};let x;try{let P=f?o:o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");l&&(P=`\\b${P}\\b`),x=new RegExp(P,v?"g":"gi")}catch{return{processedLines:n,stats:{count:0,distribution:w}}}return{processedLines:n.map((P,h)=>{let k=P.displayContent||P.content,S=k.match(x);if(S){L+=S.length,w[Math.floor(h/p)]++;let M=k.replace(x,g);return{...P,displayContent:M}}return P}),stats:{count:L,distribution:w}}};var qt={FILTER:bt,HIGHLIGHT:vt,RANGE:wt,TIME_RANGE:yt,LEVEL:Nt,TRANSFORM:Lt},kt=(n,b,p)=>{let o=qt[b.type];return o?o(n,b,p):{processedLines:n,stats:{count:0,distribution:new Array(20).fill(0)}}};import{Fragment as Qt,jsx as d,jsxs as J}from"react/jsx-runtime";var _e="system-default-preset",Ke=100,Yt=()=>{let[n,b]=A("layers"),[p,o]=A(null),[g,f]=A("idle"),[v,l]=A(null),[w,L]=A(null),[x,m]=A(!1),[P,h]=A(!1),[k,S]=A([]),[M,N]=A([]),[I,C]=A({}),[G,re]=A({}),[O,$]=A([]),[xe,ce]=A([]),[Pe,Ce]=A([]),[Te,Ee]=A([]),[Ae,De]=A(""),[Fe,e]=A(0),[F,T]=A(0),[H,Q]=A(!1),[U,he]=A(!1),[_,be]=A(""),[q,Re]=A({regex:!1,caseSensitive:!1,wholeWord:!1}),[r,te]=A(-1),ve=Mt(null),we=Mt(0),ie=Me((t,s=!1)=>{$(a=>{let u=typeof t=="function"?t(a):t;return!s&&JSON.stringify(a)!==JSON.stringify(u)&&(ce(c=>[...c.slice(-(Ke-1)),a]),Ce([])),u})},[]),Oe=Me(()=>{ce(t=>{if(t.length===0)return t;let s=t[t.length-1];return $(a=>(Ce(u=>[a,...u.slice(0,Ke-1)]),s)),t.slice(0,-1)})},[]),We=Me(()=>{Ce(t=>{if(t.length===0)return t;let s=t[0];return $(a=>(ce(u=>[...u.slice(-(Ke-1)),a]),s)),t.slice(1)})},[]);je(()=>{let t=s=>{let a=s.key.toLowerCase()==="z",u=s.key.toLowerCase()==="y",c=s.key.toLowerCase()==="f",z=s.key.toLowerCase()==="g",V=s.metaKey||s.ctrlKey,X=s.shiftKey;if(V&&a)s.preventDefault(),X?We():Oe();else if(V&&u)s.preventDefault(),We();else if(V&&c){s.preventDefault();let j=window.getSelection()?.toString();if(j){let ee=j.split(/\r?\n/)[0].trim();ee&&be(ee)}m(!0)}else V&&z?(s.preventDefault(),h(!0)):s.key==="Escape"&&(x&&m(!1),P&&h(!1))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[Oe,We,x,P]),je(()=>{let t=localStorage.getItem("loglayer_presets"),s=[];if(t)try{s=JSON.parse(t)}catch(u){console.error("Failed to load presets",u)}let a=s.find(u=>u.id===_e||u.name==="\u9ED8\u8BA4"||u.name==="Default");a?a.id=_e:(a={id:_e,name:"\u9ED8\u8BA4\u9884\u8BBE",layers:[{id:"folder-1",name:"\u7CFB\u7EDF\u65E5\u5FD7",type:"FOLDER",enabled:!0,isCollapsed:!1,config:{}},{id:"1",name:"\u4EC5\u9650\u9519\u8BEF",type:"LEVEL",enabled:!0,groupId:"folder-1",config:{levels:["ERROR","FATAL"]}}]},s.unshift(a)),Ee(s),ie(JSON.parse(JSON.stringify(a.layers)),!0),localStorage.setItem("loglayer_presets",JSON.stringify(s))},[ie]);let St=async t=>{let s=t.target.files?.[0];if(!s)return;ve.current&&ve.current.abort(),ve.current=new AbortController,De(s.name),e(s.size),S([]),T(0),Q(!0);let u=s.stream().getReader(),c=new TextDecoder,z="",V=0,X=5e5,j=[];try{for(;;){let{done:ee,value:ne}=await u.read();if(ee)break;V+=ne.byteLength;let ze=c.decode(ne,{stream:!0}),fe=(z+ze).split(/\r?\n/);z=fe.pop()||"";for(let D=0;D<fe.length;D++)j.push(fe[D]),j.length>=X&&(S(de=>de.concat(j)),j=[],T(Math.round(V/s.size*100)),await new Promise(de=>setTimeout(de,0)))}(z||j.length>0)&&(z&&j.push(z),S(ee=>ee.concat(j))),T(100)}catch(ee){ee.name!=="AbortError"&&console.error("Error reading file:",ee)}finally{Q(!1),ve.current=null}},Je=Me(async(t,s,a,u)=>{let c=++we.current;he(!0);let z={},V={};if(s.forEach(D=>{z[D.id]={count:0,distribution:new Array(20).fill(0)},V[D.id]=new Array(20).fill(0)}),!t.length){N([]),C(z),he(!1);return}let X=[...s],j="global-search-volatile";a&&(X.push({id:j,name:"\u5168\u5C40\u641C\u7D22",type:"HIGHLIGHT",enabled:!0,config:{query:a,...u,color:"#facc15",opacity:100}}),z[j]={count:0,distribution:new Array(20).fill(0)});let ee=X.filter(D=>{if(!D.enabled||D.type==="FOLDER")return!1;if(D.groupId){let de=s.find(Ze=>Ze.id===D.groupId);if(de&&!de.enabled)return!1}return!0}),ne=null,ze=!1;for(let D of ee){if(c!==we.current)return;let de=performance.now();if((D.type==="HIGHLIGHT"||D.type==="TRANSFORM")&&!ze){let ae=ne||null,Se=ae?ae.length:t.length,et=new Array(Se),tt=2e5;for(let $e=0;$e<Se;$e+=tt){if(c!==we.current)return;let Wt=Math.min($e+tt,Se);for(let ue=$e;ue<Wt;ue++)et[ue]=ae?ae[ue]:{index:ue,content:t[ue]};performance.now()-de>30&&await new Promise(ue=>setTimeout(ue,0))}ne=et,ze=!0}let Ue=ne||t.map((ae,Se)=>({index:Se,content:ae})),At=Math.max(1,Math.ceil(Ue.length/20)),{processedLines:Dt,stats:Ge}=kt(Ue,D,At);ne=Dt;let Ft=Math.max(...Ge.distribution,1);z[D.id]={count:Ge.count,distribution:Ge.distribution.map(ae=>ae/Ft)},await new Promise(ae=>setTimeout(ae,5))}let fe=ne||[];if(!ne&&t.length>0){fe=new Array(t.length);for(let D=0;D<t.length;D++)fe[D]={index:D,content:t[D]}}c===we.current&&(N(fe),C(z),re(V),he(!1),te(-1))},[]);je(()=>{let t=k.length>5e6?1500:k.length>1e6?800:250,s=setTimeout(()=>{Je(k,O,_,q)},t);return()=>clearTimeout(s)},[k,O,_,q,Je]);let ge=t=>{let s=Math.random().toString(36).substr(2,9),a;if(p){let c=O.find(z=>z.id===p);c?.type==="FOLDER"?a=c.id:c?.groupId&&(a=c.groupId)}let u={id:s,name:t==="FOLDER"?"\u65B0\u5EFA\u6587\u4EF6\u5939":t==="TIME_RANGE"?"\u65F6\u95F4\u8FC7\u6EE4":t==="RANGE"?"\u884C\u53F7\u8303\u56F4":t==="TRANSFORM"?"\u5185\u5BB9\u8F6C\u6362":t==="LEVEL"?"\u65E5\u5FD7\u7B49\u7EA7":t==="FILTER"?"\u5185\u5BB9\u8FC7\u6EE4":t==="HIGHLIGHT"?"\u9AD8\u4EAE\u56FE\u5C42":"\u65B0\u5EFA\u56FE\u5C42",type:t,enabled:!0,groupId:a,isCollapsed:!1,config:t==="HIGHLIGHT"?{color:"#3b82f6",opacity:100,query:""}:t==="TIME_RANGE"?{startTime:"",endTime:"",timeFormat:"(\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2})"}:t==="RANGE"?{from:1,to:1e3}:t==="TRANSFORM"?{query:"",replaceWith:"",regex:!0}:t==="LEVEL"?{levels:["ERROR","WARN"]}:{}};ie(c=>[...c,u]),o(s)},It=Me((t,s,a)=>{ie(u=>{let c=[...u],z=c.findIndex(X=>X.id===t);if(z===-1)return u;let[V]=c.splice(z,1);if(a==="inside"&&s){V.groupId=s;let X=c.findIndex(j=>j.id===s);c.splice(X+1,0,V)}else if(s){let X=c.findIndex(ee=>ee.id===s);V.groupId=c[X].groupId;let j=a==="before"?X:X+1;c.splice(j,0,V)}else V.groupId=void 0,c.push(V);return c})},[ie]),He=t=>{let s=M.length;if(s===0)return;let a=Math.max(0,Math.min(t,s-1));l(a),L(a),setTimeout(()=>l(null),50)},Pt=()=>{w!==null&&L(null),!x&&n!=="search"&&_&&be("")},qe=Me(t=>{if(!_||M.length===0)return;let s;try{let c=q.regex?_:_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");q.wholeWord&&(c=`\\b${c}\\b`),s=new RegExp(c,q.caseSensitive?"":"i")}catch{return}let a=r===-1?0:r,u=-1;if(t==="next"){for(let c=a+1;c<M.length;c++)if(s.test(M[c].content)){u=c;break}if(u===-1){for(let c=0;c<=a;c++)if(s.test(M[c].content)){u=c;break}}}else{for(let c=a-1;c>=0;c--)if(s.test(M[c].content)){u=c;break}if(u===-1){for(let c=M.length-1;c>=a;c--)if(s.test(M[c].content)){u=c;break}}}u!==-1&&(te(u),He(u))},[_,M,q,r,He]),Tt=()=>{let t=prompt("\u8F93\u5165\u9884\u8BBE\u540D\u79F0 (\u8F93\u5165 '\u9ED8\u8BA4' \u5C06\u66F4\u65B0\u7CFB\u7EDF\u8BBE\u7F6E):");t&&(Ee(s=>{let a=[...s],u=a.findIndex(z=>z.name.toLowerCase()===t.toLowerCase()),c={id:u>=0?a[u].id:Date.now().toString(),name:u>=0?a[u].name:t,layers:JSON.parse(JSON.stringify(O))};return u>=0?a[u]=c:a=[c,...a],localStorage.setItem("loglayer_presets",JSON.stringify(a)),a}),f("saved"),setTimeout(()=>f("idle"),1e3))},Ye=Ve(()=>({...I}),[I]),Qe=Ve(()=>I["global-search-volatile"]?.count||0,[I]),Xe=Ve(()=>{if(r===-1||!_)return 0;let t;try{let a=q.regex?_:_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");q.wholeWord&&(a=`\\b${a}\\b`),t=new RegExp(a,q.caseSensitive?"":"i")}catch{return 0}let s=0;for(let a=0;a<=r;a++)t.test(M[a].content)&&s++;return s},[r,_,q,M]);return J("div",{className:"flex flex-col h-screen select-none overflow-hidden text-sm bg-[#1e1e1e] text-[#cccccc]",children:[J("div",{className:"h-9 bg-[#2d2d2d] flex items-center px-4 border-b border-[#111] shrink-0 justify-between",children:[J("div",{className:"flex items-center space-x-4",children:[J("span",{className:"text-blue-400 font-black tracking-tighter flex items-center cursor-default",children:[d("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:d("path",{d:"M12 2L2 7l10 5 10-5-10-5-10-5zM2 17l10 5 10-5-10-5-10 5zM2 12l10 5 10-5-10-5-10 5z"})}),"LOGLAYER PRO"]}),J("label",{className:"cursor-pointer text-[10px] font-bold text-gray-400 hover:text-white bg-[#3c3c3c] px-2 py-1 rounded transition-all hover:bg-[#444]",children:[H?`\u52A0\u8F7D\u4E2D ${F}%`:"\u6253\u5F00\u65E5\u5FD7",d("input",{type:"file",className:"hidden",onChange:St,disabled:H})]})]}),d("div",{className:"text-[10px] text-gray-500 font-mono truncate max-w-xs",children:Ae||(H?"\u6B63\u5728\u89E3\u6790\u6587\u4EF6...":"\u5C31\u7EEA")})]}),(H||U)&&d("div",{className:"h-0.5 w-full bg-[#111] overflow-hidden relative",children:d("div",{className:`h-full bg-blue-500 transition-all duration-300 ${U?"animate-pulse":""}`,style:{width:U?"100%":`${F}%`}})}),J("div",{className:"flex-1 flex overflow-hidden",children:[d(rt,{activeView:n,onSetActiveView:b}),J("div",{className:"w-72 bg-[#252526] border-r border-[#111] flex flex-col shrink-0 shadow-lg",children:[n==="explorer"&&d(mt,{fileName:Ae,fileSize:Fe,onFileSelect:()=>document.querySelector('input[type="file"]')?.click()}),n==="layers"&&J("div",{className:"flex-1 flex flex-col overflow-hidden",children:[J("div",{className:"p-3 border-b border-[#111] bg-[#2d2d2d] shrink-0",children:[J("div",{className:"flex items-center justify-between mb-2",children:[d("h2",{className:"text-[10px] uppercase font-black opacity-40 tracking-wider",children:"\u56FE\u5C42\u9762\u677F"}),J("div",{className:"flex items-center space-x-0.5 border-l border-white/10 pl-2",children:[d("button",{onClick:Oe,disabled:xe.length===0,className:`p-1 rounded ${xe.length>0?"text-gray-400 hover:bg-[#444] hover:text-white":"text-gray-700 cursor-not-allowed"}`,title:"\u64A4\u9500 (Ctrl+Z)",children:d("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),d("button",{onClick:We,disabled:Pe.length===0,className:`p-1 rounded ${Pe.length>0?"text-gray-400 hover:bg-[#444] hover:text-white":"text-gray-700 cursor-not-allowed"}`,title:"\u91CD\u505A (Ctrl+Y)",children:d("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M21 10H11a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})})})]})]}),J("div",{className:"flex flex-wrap gap-1 items-center",children:[d("button",{onClick:()=>ge("FOLDER"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-gray-400",title:"\u6DFB\u52A0\u6587\u4EF6\u5939",children:d("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2.5",viewBox:"0 0 24 24",children:d("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),d("button",{onClick:()=>ge("FILTER"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-blue-400",title:"\u6DFB\u52A0\u5185\u5BB9\u8FC7\u6EE4",children:d("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:d("path",{d:"M3 4h18l-7 9v6l-4 2V13L3 4z"})})}),d("button",{onClick:()=>ge("HIGHLIGHT"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-yellow-400",title:"\u6DFB\u52A0\u9AD8\u4EAE\u56FE\u5C42",children:d("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:d("path",{d:"M12 21a9 9 0 110-18 9 9 0 010 18z"})})}),d("button",{onClick:()=>ge("TIME_RANGE"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-purple-400",title:"\u6DFB\u52A0\u65F6\u95F4\u8FC7\u6EE4\u5668",children:d("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"3",viewBox:"0 0 24 24",children:d("path",{d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),d("button",{onClick:()=>ge("LEVEL"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-red-400",title:"\u6DFB\u52A0\u7B49\u7EA7\u8FC7\u6EE4\u5668",children:d("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"3",viewBox:"0 0 24 24",children:d("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),d("button",{onClick:()=>ge("RANGE"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-teal-400",title:"\u6DFB\u52A0\u884C\u53F7\u8303\u56F4\u8FC7\u6EE4\u5668",children:d("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"3",viewBox:"0 0 24 24",children:d("path",{d:"M7 8l-4 4 4 4M17 8l4 4-4 4M13 4l-2 16"})})}),d("button",{onClick:()=>ge("TRANSFORM"),className:"w-7 h-7 flex items-center justify-center hover:bg-[#444] rounded text-orange-400",title:"\u6DFB\u52A0\u8F6C\u6362\u56FE\u5C42",children:d("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"3",viewBox:"0 0 24 24",children:d("path",{d:"M4 4h16v16H4V4zm4 4h8v8H8V8z"})})})]})]}),d("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:d(dt,{layers:O,stats:I,rawCounts:G,selectedId:p,onSelect:o,onDrop:It,onJumpToLine:He,onRemove:t=>ie(s=>s.filter(a=>a.id!==t&&a.groupId!==t)),onToggle:t=>ie(s=>s.map(a=>a.id===t?{...a,enabled:!a.enabled}:a)),onUpdate:(t,s)=>ie(a=>a.map(u=>u.id===t?{...u,...s}:u))})}),d("div",{className:"p-2 border-t border-[#111] bg-[#2d2d2d] shrink-0",children:d("button",{onClick:Tt,className:`w-full py-1.5 rounded text-[10px] font-bold uppercase tracking-wider ${g==="saved"?"bg-green-600":"bg-blue-600 hover:bg-blue-500"} text-white shadow-lg transition-all`,children:g==="saved"?"\u5DF2\u66F4\u65B0":"\u4FDD\u5B58\u5F53\u524D\u56FE\u5C42\u7EC4"})})]}),n==="search"&&d(ut,{onSearch:be,config:q,setConfig:Re,matchCount:Qe,onNavigate:qe,currentIndex:Xe}),n==="presets"&&d(ft,{presets:Te,onApply:t=>ie(JSON.parse(JSON.stringify(t.layers))),onDelete:t=>{let s=Te.filter(a=>a.id!==t);Ee(s),localStorage.setItem("loglayer_presets",JSON.stringify(s))}})]}),d("div",{className:"flex-1 flex flex-col min-w-0 bg-[#1e1e1e] relative select-text",children:n==="help"?d(xt,{}):J(Qt,{children:[U&&d("div",{className:"absolute inset-0 bg-black/40 z-20 flex items-center justify-center pointer-events-none backdrop-blur-[2px]",children:J("div",{className:"bg-[#252526] px-8 py-5 rounded border border-[#444] shadow-2xl flex flex-col items-center space-y-4",children:[d("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent animate-spin rounded-full"}),J("div",{className:"flex flex-col items-center",children:[d("span",{className:"text-[12px] font-black tracking-[0.2em] text-blue-400 uppercase",children:"\u6B63\u5728\u66F4\u65B0\u5904\u7406\u7BA1\u9053"}),J("span",{className:"text-[10px] text-gray-500 font-mono mt-2 italic",children:["\u6B63\u5728\u4F18\u5316 ",M.length.toLocaleString()," \u884C\u6570\u636E..."]})]})]})}),x&&d(pt,{query:_,onQueryChange:be,config:q,onConfigChange:Re,matchCount:Qe,currentMatch:Xe,onNavigate:qe,onClose:()=>m(!1)}),P&&d(gt,{totalLines:M.length,onGo:t=>{He(t-1),h(!1)},onClose:()=>h(!1)}),d(at,{lines:M,searchQuery:_,searchConfig:q,scrollToIndex:v,highlightedIndex:w,onLineClick:Pt}),d("div",{className:"absolute right-0 top-0 bottom-0 w-3 bg-black/20 pointer-events-none border-l border-white/5 select-none",children:Object.keys(Ye).map(t=>{let s=Ye[t],a=O.find(u=>u.id===t)||(t==="global-search-volatile"?{type:"HIGHLIGHT",config:{color:"#facc15"},enabled:!0}:null);return!a||!a.enabled||!s?null:s.distribution.map((u,c)=>u>0&&d("div",{className:"absolute w-full",style:{top:`${c/20*100}%`,height:"5%",backgroundColor:a.config.color||"#3b82f6",opacity:u*.6}},`${t}-${c}`))})})]})})]}),d(ht,{lines:M.length,totalLines:k.length,size:Fe,isProcessing:H||U})]})},Ct=Yt;import{jsx as Et}from"react/jsx-runtime";var Rt=document.getElementById("root");if(!Rt)throw new Error("Could not find root element to mount to");var Ut=Zt(Rt);Ut.render(Et(Xt.StrictMode,{children:Et(Ct,{})}));
//# sourceMappingURL=bundle.js.map
